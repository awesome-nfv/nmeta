# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#    http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
# implied.
# See the License for the specific language governing permissions and
# limitations under the License.

"""
Packets with metadata to use in testing of nmeta suite

This flow is IPv4 + TCP + HTTP with a GET returning a simple HTML
object and the session

    Note: no testing of max_interpacket_interval and
    min_interpacket_interval as they become imprecise due
    to floating point and when tried using decimal module
    found that would not serialise into Pymongo db.

    To create test packet data, capture packet in Wireshark and:

      For the packet summary:
        Right-click packet in top pane, Copy -> Summary (text).
        Edit pasted text as appropriate

      For the packet hex:
        Right-click packet in top pane, Copy -> Bytes -> Hex Stream

      For the packet timestamp:
        Expand 'Frame' in the middle pane,
        right-click 'Epoch Time' Copy -> Value

Packet capture file is 'packets_ipv4_http2.pcap'
"""

import binascii

#======================== IPv4 + TCP + HTTP port 80 flow ======================
#*** Raw packet data:
RAW = []
#*** Packet on the wire lengths in bytes:
LEN = []
#*** Ethernet parameters:
ETH_SRC = []
ETH_DST = []
ETH_TYPE = []
#*** IP addresses:
IP_SRC = []
IP_DST = []
#*** IP protocol number in decimal:
PROTO = []
#*** Transport-layer protocol numbers in decimal:
TP_SRC = []
TP_DST = []
#*** Transport-layer sequence numbers in decimal:
TP_SEQ_SRC = []
TP_SEQ_DST = []
#*** TCP FLAGS:
TCP_SYN = []
TCP_FIN = []
TCP_RST = []
TCP_PSH = []
TCP_ACK = []
#*** HEX-encoded payload
PAYLOAD = []
#*** Packet direction, c2s (client to server) or s2c
DIRECTION = []

#*** Packet 1 - Client TCP SYN
# 74 10.1.0.1 10.1.0.2 TCP 38435 80 [SYN] Seq=2044290644 Win=29200 Len=0 MSS=1460 SACK_PERM=1 TSval=10550733 TSecr=0 WS=64
RAW.append(binascii.unhexlify("080027c8db910800272ad6dd08004500003c9b99400040068b1e0a0100010a0100029623005079d9665400000000a00272104cdd0000020405b40402080a00a0fdcd0000000001030306"))
LEN.append(74)
ETH_SRC.append('08:00:27:2a:d6:dd')
ETH_DST.append('08:00:27:c8:db:91')
ETH_TYPE.append(2048)
IP_SRC.append('10.1.0.1')
IP_DST.append('10.1.0.2')
PROTO.append(6)
TP_SRC.append(38435)
TP_DST.append(80)
TP_SEQ_SRC.append(2044290644)
TP_SEQ_DST.append(0)
TCP_SYN.append(1)
TCP_FIN.append(0)
TCP_RST.append(0)
TCP_PSH.append(0)
TCP_ACK.append(0)
PAYLOAD.append("")
DIRECTION.append("c2s")

#*** Packet 2 - Server TCP SYN ACK
# 74 10.1.0.2 10.1.0.1 TCP 80 38435 [SYN, ACK] Seq=2865081127 Ack=2044290645 Win=28960 Len=0 MSS=1460 SACK_PERM=1 TSval=10545252 TSecr=10550733 WS=64
RAW.append(binascii.unhexlify("0800272ad6dd080027c8db9108004500003c00004000400626b80a0100020a01000100509623aac5ab2779d96655a01271200eca0000020405b40402080a00a0e86400a0fdcd01030306"))
LEN.append(74)
ETH_SRC.append('08:00:27:c8:db:91')
ETH_DST.append('08:00:27:2a:d6:dd')
ETH_TYPE.append(2048)
IP_SRC.append('10.1.0.2')
IP_DST.append('10.1.0.1')
PROTO.append(6)
TP_SRC.append(80)
TP_DST.append(38435)
TP_SEQ_SRC.append(2865081127)
TP_SEQ_DST.append(2044290645)
TCP_SYN.append(1)
TCP_FIN.append(0)
TCP_RST.append(0)
TCP_PSH.append(0)
TCP_ACK.append(1)
PAYLOAD.append("")
DIRECTION.append("s2c")

#*** Packet 3 - Client ACK
# 66 10.1.0.1 10.1.0.2 TCP 38435 80 [ACK] Seq=2044290645 Ack=2865081128 Win=29248 Len=0 TSval=10550733 TSecr=10545252
RAW.append(binascii.unhexlify("080027c8db910800272ad6dd0800450000349b9a400040068b250a0100010a0100029623005079d96655aac5ab28801001c9acec00000101080a00a0fdcd00a0e864"))
LEN.append(66)
ETH_SRC.append('08:00:27:2a:d6:dd')
ETH_DST.append('08:00:27:c8:db:91')
ETH_TYPE.append(2048)
IP_SRC.append('10.1.0.1')
IP_DST.append('10.1.0.2')
PROTO.append(6)
TP_SRC.append(38435)
TP_DST.append(80)
TP_SEQ_SRC.append(2044290645)
TP_SEQ_DST.append(2865081128)
TCP_SYN.append(0)
TCP_FIN.append(0)
TCP_RST.append(0)
TCP_PSH.append(0)
TCP_ACK.append(1)
PAYLOAD.append("")
DIRECTION.append("c2s")

#*** Packet 4 - Client HTTP GET
# 321 10.1.0.1 10.1.0.2 HTTP GET /static/index_simple.html HTTP/1.1
RAW.append(binascii.unhexlify("080027c8db910800272ad6dd0800450001339b9b400040068a250a0100010a0100029623005079d96655aac5ab28801801c99c7500000101080a00a0fdcd00a0e864474554202f7374617469632f696e6465785f73696d706c652e68746d6c20485454502f312e310d0a486f73743a207376312e6578616d706c652e636f6d0d0a4163636570742d456e636f64696e673a20677a69702c206465666c6174652c20636f6d70726573730d0a4163636570743a202a2f2a0d0a557365722d4167656e743a20707974686f6e2d72657175657374732f322e322e312043507974686f6e2f322e372e36204c696e75782f332e31362e302d34352d67656e657269630d0a436f6e6e656374696f6e3a20636c6f73650d0a507261676d613a206e6f2d63616368650d0a43616368652d436f6e74726f6c3a206e6f2d63616368650d0a0d0a"))
LEN.append(321)
ETH_SRC.append('08:00:27:2a:d6:dd')
ETH_DST.append('08:00:27:c8:db:91')
ETH_TYPE.append(2048)
IP_SRC.append('10.1.0.1')
IP_DST.append('10.1.0.2')
PROTO.append(6)
TP_SRC.append(38435)
TP_DST.append(80)
TP_SEQ_SRC.append(2044290645)
TP_SEQ_DST.append(2865081128)
TCP_SYN.append(0)
TCP_FIN.append(0)
TCP_RST.append(0)
TCP_PSH.append(1)
TCP_ACK.append(1)
PAYLOAD.append("474554202f7374617469632f696e6465785f73696d706c652e68746d6c20485454502f312e310d0a486f73743a207376312e6578616d706c652e636f6d0d0a4163636570742d456e636f64696e673a20677a69702c206465666c6174652c20636f6d70726573730d0a4163636570743a202a2f2a0d0a557365722d4167656e743a20707974686f6e2d72657175657374732f322e322e312043507974686f6e2f322e372e36204c696e75782f332e31362e302d34352d67656e657269630d0a436f6e6e656374696f6e3a20636c6f73650d0a507261676d613a206e6f2d63616368650d0a43616368652d436f6e74726f6c3a206e6f2d63616368650d0a0d0a")
DIRECTION.append("c2s")

#*** Packet 5 - Server ACK
# 66 10.1.0.2 10.1.0.1 TCP 80 38435 [ACK] Seq=2865081128 Ack=2044290900 Win=30080 Len=0 TSval=10545252 TSecr=10550733
RAW.append(binascii.unhexlify("0800272ad6dd080027c8db91080045000034434c40004006e3730a0100020a01000100509623aac5ab2879d96754801001d6abe000000101080a00a0e86400a0fdcd"))
LEN.append(66)
ETH_SRC.append('08:00:27:c8:db:91')
ETH_DST.append('08:00:27:2a:d6:dd')
ETH_TYPE.append(2048)
IP_SRC.append('10.1.0.2')
IP_DST.append('10.1.0.1')
PROTO.append(6)
TP_SRC.append(80)
TP_DST.append(38435)
TP_SEQ_SRC.append(2865081128)
TP_SEQ_DST.append(2044290900)
TCP_SYN.append(0)
TCP_FIN.append(0)
TCP_RST.append(0)
TCP_PSH.append(0)
TCP_ACK.append(1)
PAYLOAD.append("")
DIRECTION.append("s2c")

#*** Packet 6 - Server HTTP 200 OK
# 273 10.1.0.2 10.1.0.1 TCP [TCP segment of a reassembled PDU]
RAW.append(binascii.unhexlify("0800272ad6dd080027c8db91080045000103434d40004006e2a30a0100020a01000100509623aac5ab2879d96754801801d638ec00000101080a00a0e86400a0fdcd485454502f312e3120323030200d0a455461673a2022313437363531363533332e3638220d0a436f6e74656e742d747970653a20746578742f68746d6c0d0a436f6e74656e742d4c656e6774683a203538330d0a4c6173742d4d6f6469666965643a205361742c203135204f637420323031362030373a32383a353320474d540d0a436f6e6e656374696f6e3a20636c6f73650d0a446174653a205361742c203135204f637420323031362030373a33343a323020474d540d0a5365727665723a206c6f63616c686f73740d0a0d0a"))
LEN.append(273)
ETH_SRC.append('08:00:27:c8:db:91')
ETH_DST.append('08:00:27:2a:d6:dd')
ETH_TYPE.append(2048)
IP_SRC.append('10.1.0.2')
IP_DST.append('10.1.0.1')
PROTO.append(6)
TP_SRC.append(80)
TP_DST.append(38435)
TP_SEQ_SRC.append(2865081128)
TP_SEQ_DST.append(2044290900)
TCP_SYN.append(0)
TCP_FIN.append(0)
TCP_RST.append(0)
TCP_PSH.append(1)
TCP_ACK.append(1)
PAYLOAD.append("485454502f312e3120323030200d0a455461673a2022313437363531363533332e3638220d0a436f6e74656e742d747970653a20746578742f68746d6c0d0a436f6e74656e742d4c656e6774683a203538330d0a4c6173742d4d6f6469666965643a205361742c203135204f637420323031362030373a32383a353320474d540d0a436f6e6e656374696f6e3a20636c6f73650d0a446174653a205361742c203135204f637420323031362030373a33343a323020474d540d0a5365727665723a206c6f63616c686f73740d0a0d0a")
DIRECTION.append("s2c")

#*** Packet 7 - Client ACK
# 66 10.1.0.1 10.1.0.2 TCP 38435?80 [ACK] Seq=2044290900 Ack=2865081335 Win=30272 Len=0 TSval=10550734 TSecr=10545252
RAW.append(binascii.unhexlify("080027c8db910800272ad6dd0800450000349b9c400040068b230a0100010a0100029623005079d96754aac5abf7801001d9ab0d00000101080a00a0fdce00a0e864"))
LEN.append(66)
ETH_SRC.append('08:00:27:2a:d6:dd')
ETH_DST.append('08:00:27:c8:db:91')
ETH_TYPE.append(2048)
IP_SRC.append('10.1.0.1')
IP_DST.append('10.1.0.2')
PROTO.append(6)
TP_SRC.append(38435)
TP_DST.append(80)
TP_SEQ_SRC.append(2044290900)
TP_SEQ_DST.append(2865081335)
TCP_SYN.append(0)
TCP_FIN.append(0)
TCP_RST.append(0)
TCP_PSH.append(0)
TCP_ACK.append(1)
PAYLOAD.append("")
DIRECTION.append("c2s")

#*** Packet 8 - Server sends HTML Page to Client
# 649 10.1.0.2 10.1.0.1 HTTP HTTP/1.1 200   (text/html)
RAW.append(binascii.unhexlify("0800272ad6dd080027c8db9108004500027b434e40004006e12a0a0100020a01000100509623aac5abf779d96754801801d6918500000101080a00a0e86400a0fdcd3c21646f63747970652068746d6c3e0a3c68746d6c3e0a3c686561643e0a202020203c7469746c653e4578616d706c6520506167653c2f7469746c653e0a202020203c6d65746120636861727365743d227574662d3822202f3e0a202020203c6d65746120687474702d65717569763d22436f6e74656e742d747970652220636f6e74656e743d22746578742f68746d6c3b20636861727365743d7574662d3822202f3e0a3c2f686561643e0a0a3c626f64793e0a3c68313e4578616d706c6520506167653c2f68313e0a0a22596f75206b6e6f772c20746865206d6f737420616d617a696e67207468696e672068617070656e656420746f206d6520746f6e696768742e2e2e204920736177206120636172207769746820746865206c6963656e736520706c61746520415257203335372e2043616e20796f7520696d6167696e653f204f6620616c6c20746865206d696c6c696f6e73206f66206c6963656e736520706c6174657320696e207468652073746174652c20776861742077617320746865206368616e63652074686174204920776f756c6420736565207468617420706172746963756c6172206f6e6520746f6e696768743f20416d617a696e6721220a202d2052696368617264204665796e6d616e0a3c703e200a224e6174696f6e616c69736d20697320616e20696e66616e74696c6520646973656173652e20497420697320746865206d6561736c6573206f66206d616e6b696e642e220a202d20416c626572742045696e737465696e0a0a3c2f626f64793e0a3c2f68746d6c3e0a0a"))
LEN.append(649)
ETH_SRC.append('08:00:27:c8:db:91')
ETH_DST.append('08:00:27:2a:d6:dd')
ETH_TYPE.append(2048)
IP_SRC.append('10.1.0.2')
IP_DST.append('10.1.0.1')
PROTO.append(6)
TP_SRC.append(80)
TP_DST.append(38435)
TP_SEQ_SRC.append(2865081335)
TP_SEQ_DST.append(2044290900)
TCP_SYN.append(0)
TCP_FIN.append(0)
TCP_RST.append(0)
TCP_PSH.append(1)
TCP_ACK.append(1)
PAYLOAD.append("3c21646f63747970652068746d6c3e0a3c68746d6c3e0a3c686561643e0a202020203c7469746c653e4578616d706c6520506167653c2f7469746c653e0a202020203c6d65746120636861727365743d227574662d3822202f3e0a202020203c6d65746120687474702d65717569763d22436f6e74656e742d747970652220636f6e74656e743d22746578742f68746d6c3b20636861727365743d7574662d3822202f3e0a3c2f686561643e0a0a3c626f64793e0a3c68313e4578616d706c6520506167653c2f68313e0a0a22596f75206b6e6f772c20746865206d6f737420616d617a696e67207468696e672068617070656e656420746f206d6520746f6e696768742e2e2e204920736177206120636172207769746820746865206c6963656e736520706c61746520415257203335372e2043616e20796f7520696d6167696e653f204f6620616c6c20746865206d696c6c696f6e73206f66206c6963656e736520706c6174657320696e207468652073746174652c20776861742077617320746865206368616e63652074686174204920776f756c6420736565207468617420706172746963756c6172206f6e6520746f6e696768743f20416d617a696e6721220a202d2052696368617264204665796e6d616e0a3c703e200a224e6174696f6e616c69736d20697320616e20696e66616e74696c6520646973656173652e20497420697320746865206d6561736c6573206f66206d616e6b696e642e220a202d20416c626572742045696e737465696e0a0a3c2f626f64793e0a3c2f68746d6c3e0a0a")
DIRECTION.append("s2c")

#*** Packet 9 - Client ACK
# 66 10.1.0.1 10.1.0.2 TCP 38435?80 [ACK] Seq=2044290900 Ack=2865081918 Win=31488 Len=0 TSval=10550734 TSecr=10545252
RAW.append(binascii.unhexlify("080027c8db910800272ad6dd0800450000349b9d400040068b220a0100010a0100029623005079d96754aac5ae3e801001eca8b300000101080a00a0fdce00a0e864"))
LEN.append(66)
ETH_SRC.append('08:00:27:2a:d6:dd')
ETH_DST.append('08:00:27:c8:db:91')
ETH_TYPE.append(2048)
IP_SRC.append('10.1.0.1')
IP_DST.append('10.1.0.2')
PROTO.append(6)
TP_SRC.append(38435)
TP_DST.append(80)
TP_SEQ_SRC.append(2044290900)
TP_SEQ_DST.append(2865081918)
TCP_SYN.append(0)
TCP_FIN.append(0)
TCP_RST.append(0)
TCP_PSH.append(0)
TCP_ACK.append(1)
PAYLOAD.append("")
DIRECTION.append("c2s")

#*** Packet 10 - Server FIN ACK
# 66 10.1.0.2 10.1.0.1 TCP 80 38435 [FIN, ACK] Seq=2865081918 Ack=2044290900 Win=30080 Len=0 TSval=10545252 TSecr=10550733
RAW.append(binascii.unhexlify("0800272ad6dd080027c8db91080045000034434f40004006e3700a0100020a01000100509623aac5ae3e79d96754801101d6a8c900000101080a00a0e86400a0fdcd"))
LEN.append(66)
ETH_SRC.append('08:00:27:c8:db:91')
ETH_DST.append('08:00:27:2a:d6:dd')
ETH_TYPE.append(2048)
IP_SRC.append('10.1.0.2')
IP_DST.append('10.1.0.1')
PROTO.append(6)
TP_SRC.append(80)
TP_DST.append(38435)
TP_SEQ_SRC.append(2865081918)
TP_SEQ_DST.append(2044290900)
TCP_SYN.append(0)
TCP_FIN.append(1)
TCP_RST.append(0)
TCP_PSH.append(0)
TCP_ACK.append(1)
PAYLOAD.append("")
DIRECTION.append("s2c")

#*** Packet 11 - Client FIN ACK
# 66 10.1.0.1 10.1.0.2 TCP 38435 80 [FIN, ACK] Seq=2044290900 Ack=2865081919 Win=31488 Len=0 TSval=10550734 TSecr=10545252
RAW.append(binascii.unhexlify("080027c8db910800272ad6dd0800450000349b9e400040068b210a0100010a0100029623005079d96754aac5ae3f801101eca8b100000101080a00a0fdce00a0e864"))
LEN.append(66)
ETH_SRC.append('08:00:27:2a:d6:dd')
ETH_DST.append('08:00:27:c8:db:91')
ETH_TYPE.append(2048)
IP_SRC.append('10.1.0.1')
IP_DST.append('10.1.0.2')
PROTO.append(6)
TP_SRC.append(38435)
TP_DST.append(80)
TP_SEQ_SRC.append(2044290900)
TP_SEQ_DST.append(2865081919)
TCP_SYN.append(0)
TCP_FIN.append(1)
TCP_RST.append(0)
TCP_PSH.append(0)
TCP_ACK.append(1)
PAYLOAD.append("")
DIRECTION.append("c2s")

#*** Packet 12 - Final ACK from Server
# 66 10.1.0.2 10.1.0.1 TCP 80 38435 [ACK] Seq=2865081919 Ack=2044290901 Win=30080 Len=0 TSval=10545253 TSecr=10550734
RAW.append(binascii.unhexlify("0800272ad6dd080027c8db91080045000034435040004006e36f0a0100020a01000100509623aac5ae3f79d96755801001d6a8c600000101080a00a0e86500a0fdce"))
LEN.append(66)
ETH_SRC.append('08:00:27:c8:db:91')
ETH_DST.append('08:00:27:2a:d6:dd')
ETH_TYPE.append(2048)
IP_SRC.append('10.1.0.2')
IP_DST.append('10.1.0.1')
PROTO.append(6)
TP_SRC.append(80)
TP_DST.append(38435)
TP_SEQ_SRC.append(2865081919)
TP_SEQ_DST.append(2044290901)
TCP_SYN.append(0)
TCP_FIN.append(0)
TCP_RST.append(0)
TCP_PSH.append(0)
TCP_ACK.append(1)
PAYLOAD.append("")
DIRECTION.append("s2c")

#*** Metadata for whole flow:
FLOW_IP_CLIENT = '10.1.0.1'
FLOW_IP_SERVER = '10.1.0.2'

